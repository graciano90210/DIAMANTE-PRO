{% extends "base.html" %}

{% block title %}Nuevo Cliente - Diamante Pro{% endblock %}

{% block page_title %}Registrar Nuevo Cliente{% endblock %}

{% block extra_css %}
<style>
    .form-card {
        background: #1D1E33 !important;
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 15px;
    }
    .form-card .card-header {
        background: rgba(0, 229, 255, 0.08) !important;
        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        padding: 20px 25px;
    }
    .form-card .card-body {
        padding: 25px;
    }
    
    .section-title {
        color: #00E5FF;
        font-size: 0.9rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 1px solid rgba(0, 229, 255, 0.2);
    }
    
    .form-label {
        color: rgba(255, 255, 255, 0.8);
        font-weight: 500;
        margin-bottom: 6px;
    }
    
    .form-control, .form-select {
        background: #0A0E21 !important;
        border: 1px solid rgba(255, 255, 255, 0.15);
        color: #E0E0E0 !important;
        border-radius: 8px;
        padding: 10px 15px;
    }
    .form-control:focus, .form-select:focus {
        background: #0A0E21 !important;
        border-color: #00E5FF;
        box-shadow: 0 0 0 3px rgba(0, 229, 255, 0.2);
        color: #E0E0E0 !important;
    }
    .form-control::placeholder {
        color: rgba(255, 255, 255, 0.4);
    }
    .form-select option {
        background: #1D1E33;
        color: #E0E0E0;
    }
    
    .input-group-text {
        background: rgba(0, 229, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.15);
        color: #00E5FF;
    }
    
    .form-check-input {
        background-color: #0A0E21;
        border-color: rgba(255, 255, 255, 0.3);
    }
    .form-check-input:checked {
        background-color: #00E5FF;
        border-color: #00E5FF;
    }
    .form-check-label {
        color: rgba(255, 255, 255, 0.8);
    }
    
    .btn-guardar {
        background: linear-gradient(135deg, #00E5FF, #00FF99);
        border: none;
        color: #0A0E21;
        font-weight: 600;
        padding: 12px 30px;
        border-radius: 8px;
        transition: all 0.3s ease;
    }
    .btn-guardar:hover {
        transform: scale(1.02);
        box-shadow: 0 5px 20px rgba(0, 229, 255, 0.4);
        color: #0A0E21;
    }
    
    .btn-cancelar {
        background: transparent;
        border: 1px solid rgba(255, 255, 255, 0.3);
        color: rgba(255, 255, 255, 0.7);
        padding: 12px 30px;
        border-radius: 8px;
    }
    .btn-cancelar:hover {
        background: rgba(255, 255, 255, 0.1);
        color: #fff;
    }
    
    .text-muted {
        color: rgba(255, 255, 255, 0.5) !important;
    }
</style>
{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-10">
        <div class="form-card">
            <div class="card-header">
                <h4 class="mb-0 text-white">
                    <i class="bi bi-person-plus me-2" style="color: #00E5FF;"></i>Registrar Nuevo Cliente
                </h4>
            </div>
            <div class="card-body">
                {% if error %}
                <div class="alert alert-danger">{{ error }}</div>
                {% endif %}

                <form method="POST" action="/clientes/guardar">
                    <!-- Informaci칩n Personal -->
                    <div class="section-title">
                        <i class="bi bi-person me-2"></i>Informaci칩n Personal
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Nombre Completo *</label>
                            <input type="text" name="nombre" class="form-control" required 
                                   placeholder="Ej: Juan P칠rez Garc칤a">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">CPF (Documento) *</label>
                            <input type="text" name="documento" class="form-control" required 
                                   placeholder="Ej: 111.222.333-44">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Fecha Nacimiento</label>
                            <input type="date" name="fecha_nacimiento" class="form-control">
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-4 mb-3">
                            <label class="form-label">Tel칠fono *</label>
                            <input type="tel" name="telefono" class="form-control" required 
                                   placeholder="Ej: 3001234567">
                            <small class="text-muted">N칰mero local sin c칩digo de pa칤s</small>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label class="form-label">Estado Civil</label>
                            <select name="estado_civil" class="form-select">
                                <option value="SOLTERO">Soltero/a</option>
                                <option value="CASADO">Casado/a</option>
                                <option value="UNION_LIBRE">Uni칩n Libre</option>
                                <option value="DIVORCIADO">Divorciado/a</option>
                                <option value="VIUDO">Viudo/a</option>
                            </select>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label class="form-label">Personas a Cargo</label>
                            <input type="number" name="personas_a_cargo" class="form-control" value="0">
                        </div>
                    </div>

                    <div class="row mb-4">
                        <div class="col-md-3 mb-3">
                            <label class="form-label">C칩digo Pa칤s WhatsApp *</label>
                            <select name="whatsapp_codigo_pais" class="form-select" id="whatsappCodigo">
                                <option value="57" selected>游뻟릖 +57 (Colombia)</option>
                                <option value="1">游쥟릖 +1 (USA/Canad치)</option>
                                <option value="52">游쓇릖 +52 (M칠xico)</option>
                                <option value="51">游왫릖 +51 (Per칰)</option>
                                <option value="55">游游 +55 (Brasil)</option>
                                <option value="54">游뷣릖 +54 (Argentina)</option>
                                <option value="56">游뻟릖 +56 (Chile)</option>
                                <option value="593">游쀯릖 +593 (Ecuador)</option>
                                <option value="58">游游 +58 (Venezuela)</option>
                                <option value="507">游왫릖 +507 (Panam치)</option>
                                <option value="503">游젏릖 +503 (El Salvador)</option>
                                <option value="502">游섫릖 +502 (Guatemala)</option>
                                <option value="504">游쇓릖 +504 (Honduras)</option>
                                <option value="505">游游 +505 (Nicaragua)</option>
                                <option value="506">游뻟릖 +506 (Costa Rica)</option>
                                <option value="34">游쀯릖 +34 (Espa침a)</option>
                            </select>
                        </div>
                        <div class="col-md-9 mb-3">
                            <label class="form-label">N칰mero WhatsApp *</label>
                            <div class="input-group">
                                <span class="input-group-text" id="whatsappPrefix">+57</span>
                                <input type="tel" name="whatsapp_numero" class="form-control" required 
                                       placeholder="Ej: 3001234567" id="whatsappNumero">
                            </div>
                            <small class="text-muted">Sin c칩digo de pa칤s, solo el n칰mero local</small>
                        </div>
                    </div>

                    <!-- Informaci칩n del Negocio -->
                    <div class="section-title">
                        <i class="bi bi-shop me-2"></i>Informaci칩n del Negocio
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">CNPJ (Documento Negocio)</label>
                            <input type="text" name="documento_fiscal_negocio" class="form-control" 
                                   placeholder="Ej: 12.345.678/0001-90">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Tipo de Negocio</label>
                            <input type="text" name="tipo_negocio" class="form-control" 
                                   placeholder="Ej: Tienda, Peluquer칤a, Taller...">
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-8 mb-3">
                            <label class="form-label">Direcci칩n del Negocio</label>
                            <input type="text" name="direccion_negocio" class="form-control" 
                                   placeholder="Ej: Av. Principal 123, Sala 4">
                        </div>
                        <div class="col-md-4 mb-3">
                            <label class="form-label">CEP (Negocio)</label>
                            <input type="text" name="cep_negocio" class="form-control" 
                                   placeholder="Ej: 12345-678">
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Antig칲edad (Meses)</label>
                            <input type="number" name="antiguedad_negocio_meses" class="form-control" placeholder="0">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Ingresos Diarios</label>
                            <div class="input-group">
                                <span class="input-group-text">$</span>
                                <input type="number" step="any" name="ingresos_diarios_estimados" class="form-control">
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Gastos Mensuales</label>
                            <div class="input-group">
                                <span class="input-group-text">$</span>
                                <input type="number" step="any" name="gastos_mensuales_promedio" class="form-control">
                            </div>
                        </div>
                        <div class="col-md-3 d-flex align-items-end mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="local_propio" id="localPropio">
                                <label class="form-check-label" for="localPropio">쯃ocal Propio?</label>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-4">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">GPS Latitud (Negocio)</label>
                            <input type="number" step="any" name="gps_latitud" class="form-control" 
                                   placeholder="Ej: -23.5505">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">GPS Longitud (Negocio)</label>
                            <input type="number" step="any" name="gps_longitud" class="form-control" 
                                   placeholder="Ej: -46.6333">
                        </div>
                    </div>

                    <!-- Informaci칩n Residencial -->
                    <div class="section-title">
                        <i class="bi bi-house me-2"></i>Informaci칩n Residencial
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-8 mb-3">
                            <label class="form-label">Direcci칩n de Casa</label>
                            <input type="text" name="direccion_casa" class="form-control" 
                                   placeholder="Direcci칩n completa de residencia">
                        </div>
                        <div class="col-md-4 mb-3">
                            <label class="form-label">CEP (Casa)</label>
                            <input type="text" name="cep_casa" class="form-control">
                        </div>
                    </div>

                    <div class="row mb-4">
                        <div class="col-md-4 mb-3">
                            <label class="form-label">Tiempo Residencia (Meses)</label>
                            <input type="number" name="tiempo_residencia_meses" class="form-control" placeholder="0">
                        </div>
                        <div class="col-md-4 d-flex align-items-end mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="tiene_comprobante_residencia" id="chkComprobante">
                                <label class="form-check-label" for="chkComprobante">Tiene Comprobante</label>
                            </div>
                        </div>
                        <div class="col-md-4 d-flex align-items-end mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="comprobante_a_nombre_propio" id="chkNombrePropio">
                                <label class="form-check-label" for="chkNombrePropio">쮸 nombre propio?</label>
                            </div>
                        </div>
                    </div>

                    <!-- Botones -->
                    <div class="d-flex justify-content-end gap-3 pt-4" style="border-top: 1px solid rgba(255,255,255,0.1);">
                        <a href="/clientes" class="btn btn-cancelar">
                            <i class="bi bi-x-lg me-2"></i>Cancelar
                        </a>
                        <button type="submit" class="btn btn-guardar">
                            <i class="bi bi-check-lg me-2"></i>Guardar Cliente
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Actualizar prefijo de WhatsApp cuando cambia el c칩digo de pa칤s
    document.getElementById('whatsappCodigo').addEventListener('change', function() {
        const codigo = this.value;
        document.getElementById('whatsappPrefix').textContent = '+' + codigo;
    });

    // Validar que solo se ingresen n칰meros en el WhatsApp
    document.getElementById('whatsappNumero').addEventListener('input', function() {
        this.value = this.value.replace(/[^0-9]/g, '');
    });
</script>
{% endblock %}
