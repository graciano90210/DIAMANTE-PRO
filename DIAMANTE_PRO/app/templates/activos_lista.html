{% extends "base.html" %}

{% block title %}Activos Fijos - Diamante Pro{% endblock %}

{% block page_title %}
<i class="bi bi-box-seam me-2"></i>Activos Fijos
{% endblock %}

{% block extra_css %}
<style>
    .main-card {
        background: linear-gradient(145deg, #1D1E33 0%, #151627 100%);
        border-radius: 20px;
        border: 1px solid rgba(0, 229, 255, 0.1);
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    }
    
    .stat-card {
        background: linear-gradient(145deg, #1D1E33 0%, #151627 100%);
        border-radius: 15px;
        border: 1px solid rgba(255, 215, 0, 0.2);
        padding: 1.5rem;
        border-left: 4px solid #FFD700;
    }
    
    .stat-card .stat-icon {
        width: 50px;
        height: 50px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        background: rgba(255, 215, 0, 0.15);
        color: #FFD700;
    }
    
    .stat-card .stat-value {
        font-size: 1.75rem;
        font-weight: 700;
        color: #FFD700;
    }
    
    .stat-card .stat-label {
        color: #6c757d;
        font-size: 0.85rem;
    }
    
    .section-title {
        color: #00E5FF;
        text-transform: uppercase;
        font-size: 0.85rem;
        letter-spacing: 1px;
    }
    
    .btn-nuevo {
        background: linear-gradient(135deg, #FFD700 0%, #ccac00 100%);
        border: none;
        color: #0A0E21;
        font-weight: 600;
        border-radius: 10px;
        padding: 0.75rem 1.5rem;
        transition: all 0.3s ease;
    }
    
    .btn-nuevo:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 20px rgba(255, 215, 0, 0.3);
        color: #0A0E21;
    }
    
    .table-dark-custom {
        background: transparent;
    }
    
    .table-dark-custom thead th {
        background: rgba(255, 215, 0, 0.1);
        color: #FFD700;
        border-bottom: 1px solid rgba(255, 215, 0, 0.2);
        font-weight: 600;
        text-transform: uppercase;
        font-size: 0.8rem;
        letter-spacing: 0.5px;
        padding: 1rem 0.75rem;
    }
    
    .table-dark-custom tbody tr {
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        transition: all 0.3s ease;
    }
    
    .table-dark-custom tbody tr:hover {
        background: rgba(255, 215, 0, 0.05);
    }
    
    .table-dark-custom td {
        color: #E0E0E0;
        padding: 1rem 0.75rem;
        vertical-align: middle;
    }
    
    .badge-estado {
        padding: 0.4rem 0.75rem;
        border-radius: 8px;
        font-weight: 500;
        font-size: 0.75rem;
    }
    
    .badge-activo {
        background: rgba(0, 255, 153, 0.15);
        color: #00FF99;
        border: 1px solid rgba(0, 255, 153, 0.3);
    }
    
    .badge-mantenimiento {
        background: rgba(255, 215, 0, 0.15);
        color: #FFD700;
        border: 1px solid rgba(255, 215, 0, 0.3);
    }
    
    .badge-inactivo {
        background: rgba(108, 117, 125, 0.15);
        color: #adb5bd;
        border: 1px solid rgba(108, 117, 125, 0.3);
    }
    
    .badge-baja {
        background: rgba(255, 107, 107, 0.15);
        color: #FF6B6B;
        border: 1px solid rgba(255, 107, 107, 0.3);
    }
    
    .badge-categoria {
        background: rgba(108, 117, 125, 0.2);
        color: #adb5bd;
        padding: 0.3rem 0.6rem;
        border-radius: 6px;
        font-size: 0.75rem;
    }
    
    .badge-sociedad {
        background: rgba(0, 229, 255, 0.15);
        color: #00E5FF;
        border: 1px solid rgba(0, 229, 255, 0.3);
        padding: 0.3rem 0.6rem;
        border-radius: 6px;
        font-size: 0.75rem;
    }
    
    .badge-ruta {
        background: rgba(23, 162, 184, 0.15);
        color: #17a2b8;
        border: 1px solid rgba(23, 162, 184, 0.3);
        padding: 0.3rem 0.6rem;
        border-radius: 6px;
        font-size: 0.75rem;
    }
    
    .empty-state {
        text-align: center;
        padding: 4rem 2rem;
    }
    
    .empty-state i {
        font-size: 5rem;
        color: rgba(255, 215, 0, 0.3);
        margin-bottom: 1.5rem;
    }
    
    .empty-state h4 {
        color: #E0E0E0;
        margin-bottom: 1rem;
    }
    
    .alert-link-dark {
        color: #FFD700;
        text-decoration: underline;
    }
    
    .btn-volver {
        background: transparent;
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #B0B0B0;
        border-radius: 10px;
        transition: all 0.3s ease;
    }
    
    .btn-volver:hover {
        border-color: #00E5FF;
        color: #00E5FF;
        background: rgba(0, 229, 255, 0.1);
    }
    
    .valor-activo {
        color: #00FF99;
        font-weight: 600;
    }
    
    .detalles-activo {
        color: #6c757d;
        font-size: 0.85rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mt-4">
    <!-- Header con botón -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <p class="text-muted mb-0">Inventario y gestión de activos fijos</p>
        </div>
        <a href="/finanzas/activos/nuevo" class="btn btn-nuevo">
            <i class="bi bi-plus-circle me-2"></i>Nuevo Activo
        </a>
    </div>

    <!-- Resumen de Valor Total -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="stat-card">
                <div class="d-flex align-items-center">
                    <div class="stat-icon me-3">
                        <i class="bi bi-calculator"></i>
                    </div>
                    <div>
                        <div class="stat-value">$ {{ "{:,.0f}".format(total_valor) }}</div>
                        <div class="stat-label">Valor Total de Activos - Suma del valor de compra de todos los activos</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tabla de Activos -->
    <div class="card main-card">
        <div class="card-body p-0">
            {% if activos %}
            <div class="table-responsive">
                <table class="table table-dark-custom mb-0">
                    <thead>
                        <tr>
                            <th>Nombre</th>
                            <th>Categoría</th>
                            <th>Valor</th>
                            <th>Estado</th>
                            <th>Responsable</th>
                            <th>Sociedad/Ruta</th>
                            <th>Fecha Compra</th>
                            <th>Detalles</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for activo in activos %}
                        <tr>
                            <td><strong>{{ activo.nombre }}</strong></td>
                            <td>
                                <span class="badge badge-categoria">{{ activo.categoria }}</span>
                            </td>
                            <td class="valor-activo text-end">
                                $ {{ "{:,.0f}".format(activo.valor_compra) }}
                            </td>
                            <td>
                                {% if activo.estado == 'ACTIVO' %}
                                    <span class="badge badge-estado badge-activo">Activo</span>
                                {% elif activo.estado == 'MANTENIMIENTO' %}
                                    <span class="badge badge-estado badge-mantenimiento">Mantenimiento</span>
                                {% elif activo.estado == 'INACTIVO' %}
                                    <span class="badge badge-estado badge-inactivo">Inactivo</span>
                                {% else %}
                                    <span class="badge badge-estado badge-baja">Dado de Baja</span>
                                {% endif %}
                            </td>
                            <td>
                                {% if activo.usuario_responsable %}
                                    <i class="bi bi-person-fill me-1" style="color: #00E5FF;"></i>
                                    {{ activo.usuario_responsable.nombre }}
                                {% else %}
                                    <span class="text-muted">-</span>
                                {% endif %}
                            </td>
                            <td>
                                {% if activo.sociedad %}
                                    <span class="badge badge-sociedad">{{ activo.sociedad.nombre }}</span>
                                {% endif %}
                                {% if activo.ruta %}
                                    <span class="badge badge-ruta">{{ activo.ruta.nombre }}</span>
                                {% endif %}
                                {% if not activo.sociedad and not activo.ruta %}
                                    <span class="text-muted">-</span>
                                {% endif %}
                            </td>
                            <td>{{ activo.fecha_compra.strftime('%d/%m/%Y') }}</td>
                            <td class="detalles-activo">
                                {% if activo.marca %}{{ activo.marca }}{% endif %}
                                {% if activo.modelo %} {{ activo.modelo }}{% endif %}
                                {% if activo.placa_serial %}<br>{{ activo.placa_serial }}{% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <div class="empty-state">
                <i class="bi bi-box-seam"></i>
                <h4>No hay activos fijos registrados</h4>
                <p class="text-muted">Comienza registrando el primer activo de tu empresa.</p>
                <a href="/finanzas/activos/nuevo" class="btn btn-nuevo">
                    <i class="bi bi-plus-circle me-2"></i>Registrar Primer Activo
                </a>
            </div>
            {% endif %}
        </div>
    </div>

    <div class="mt-4">
        <a href="/dashboard" class="btn btn-volver">
            <i class="bi bi-arrow-left me-2"></i>Volver al Dashboard
        </a>
    </div>
</div>
{% endblock %}

{% block extra_js %}
{% endblock %}
